<div (click)="onClose()" 
      class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
  <div (click)="$event.stopPropagation()" 
        class="bg-white w-full max-w-2xl rounded-2xl shadow-lg p-6 relative">
    <h2 class="text-xl font-semibold mb-4">Chỉnh sửa trang cá nhân</h2>

    <div class="space-y-10 max-h-[70vh] overflow-y-auto pr-2">
      <!-- Ảnh bìa -->
      <div class="w-full mb-4">
        <label class="block text-sm font-medium mb-2">Ảnh bìa</label>
        <div class="relative flex justify-center items-center w-full">
          <img 
            [src]="coverPreviewUrl || editedProfile.coverUrl || 'https://picsum.photos/1200/400?random=1'" 
            class="h-40 md:h-56 object-cover rounded-lg border-4 border-white shadow-lg"
          />
          <label 
            class="absolute bottom-2 right-2 bg-black bg-opacity-50 text-white px-3 py-1 rounded-lg text-sm cursor-pointer hover:bg-opacity-70 z-10"
          >
            Chọn ảnh
            <input type="file" accept="image/*" hidden (change)="onCoverUrlSelected($event)">
          </label>
        </div>
        <button
          *ngIf="selectedCoverUrl"
          class="mt-4 bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600 transition"
          (click)="uploadCoverUrl()"
        >
          Lưu ảnh bìa
        </button>
      </div>

      <!-- Avatar -->
      <div class="relative flex flex-col items-start -mt-16 mb-6">
        <label class="absolute -top-6 left-0 text-sm font-medium z-10">Ảnh đại diện</label>
        <div class="flex justify-center items-center w-full relative">
          <img 
            [src]="previewUrl || editedProfile.avatarUrl || 'assets/default-avatar.jpg'" 
            class="w-44 h-44 rounded-full border-4 border-white shadow-lg object-cover"
          />
          <label 
            class="absolute bottom-0 right-0 bg-black bg-opacity-50 text-white px-3 py-1 rounded-lg text-sm cursor-pointer hover:bg-opacity-70 z-10"
          >
            Chọn ảnh
            <input type="file" accept="image/*" hidden (change)="onAvatarSelected($event)">
          </label>
        </div>
        <button
          *ngIf="selectedAvatar"
          class="mt-4 bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600 transition"
          (click)="uploadAvatar()"
        >
          Lưu ảnh đại diện
        </button>
      </div>

      <div>
        <label class="block text-sm font-medium">Tên đầy đủ</label>
        <input [(ngModel)]="editedProfile.fullName"
               class="w-full border rounded-lg p-2" />
      </div>

      <div>
        <label class="block text-sm font-medium">Username</label>
        <input [(ngModel)]="editedProfile.username"
               class="w-full border rounded-lg p-2" />
      </div>

      <div>
        <label class="block text-sm font-medium">Bio</label>
        <textarea [(ngModel)]="editedProfile.bio"
                  class="w-full border rounded-lg p-2"></textarea>
      </div>

      <div>
        <label class="block text-sm font-medium">Giới tính</label>
        <select [(ngModel)]="editedProfile.gender" class="w-full border rounded-lg p-2">
          <option value="">-- Chọn --</option>
          <option value="MALE">Nam</option>
          <option value="FEMALE">Nữ</option>
          <option value="OTHER">Khác</option>
        </select>
      </div>

      <div>
        <label class="block text-sm font-medium">Ngày sinh</label>
        <input type="date" [(ngModel)]="editedProfile.dob" class="w-full border rounded-lg p-2" />
      </div>

      <div>
        <label class="block text-sm font-medium">Địa chỉ</label>
        <input [(ngModel)]="editedProfile.location"
               class="w-full border rounded-lg p-2" />
      </div>

      <div>
        <label class="block text-sm font-medium">Website</label>
        <input [(ngModel)]="editedProfile.website"
               class="w-full border rounded-lg p-2" />
      </div>


    </div>

    <div class="flex justify-end gap-3 mt-6">
      <button (click)="onClose()" class="px-4 py-2 rounded-lg bg-gray-200">Hủy</button>
      <button (click)="onSave()" class="px-4 py-2 rounded-lg bg-blue-600 text-white">Lưu</button>
    </div>
  </div>
</div>
